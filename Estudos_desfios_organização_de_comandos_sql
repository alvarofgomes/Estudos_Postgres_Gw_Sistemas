INSERT INTO aluno (nome) VALUES ('João'), ('Nico'),('Vinicius');
INSERT INTO curso (id,nome) VALUES (1,'CSS'),(2,'POO'),(3,'JavaScript');
INSERT INTO aluno_curso (aluno_id, curso_id) VALUES (1,2), (3,1);

SELECT * FROM aluno;
SELECT * FROM aluno_curso;
SELECT * FROM curso;
SELECT * FROM funcionarios;
SELECT * FROM funcionarios_curso;

SELECT aluno.nome AS "Nome do aluno", curso.nome "Nome do curso" FROM aluno
JOIN aluno_curso ON aluno_curso.aluno_id = aluno.id
JOIN curso ON curso.id = aluno_curso.curso_id;

CREATE TABLE funcionarios(
id SERIAL PRIMARY KEY,
matricula VARCHAR(255),
nome VARCHAR(255),
sobrenome VARCHAR(2550)
);

INSERT INTO funcionarios (matricula,nome,sobrenome) VALUES
('M001','Diogo', 'Mascarenhas'),
('M002','Vinicius', 'Dias'),
('M003','Nico', 'Steppat'),
('M004','João', 'Roberto'),
('M005','Diogo', 'Mascarenhas'),
('M006','Alberto', 'Martins'),
('M007','Diogo', 'Oliveira');

create table funcionarios_curso(

	funcionarios_id INTEGER,
	curso_id INTEGER,
	PRIMARY KEY(funcionarios_id, curso_id),

	FOREIGN KEY(funcionarios_id)
	REFERENCES funcionarios(id)
	ON DELETE CASCADE
	ON UPDATE CASCADE,

	FOREIGN KEY(curso_id)
	REFERENCES curso(id)

);

INSERT INTO funcionarios_curso (funcionarios_id,curso_id) VALUES (1,1),(2,2);
-- mostrando profesores que ministram cursos e são vistos por alunos
SELECT funcionarios.nome AS "Nome do professor", curso.nome AS "Nome do curso",aluno.nome AS "Nome do aluno" 
FROM funcionarios
JOIN funcionarios_curso ON funcionarios_curso.funcionarios_id = funcionarios.id
JOIN curso ON curso.id = funcionarios_curso.curso_id
JOIN aluno_curso ON curso.id = aluno_curso.curso_id
JOIN aluno ON aluno.id = aluno_curso.aluno_id;

-- Exercício 1 — Listar apenas professores que têm alunos

SELECT funcionarios.nome AS "Nome do professor", curso.nome AS "Nome do curso",aluno.nome AS "Nome do aluno" 
FROM funcionarios
JOIN funcionarios_curso ON funcionarios_curso.funcionarios_id = funcionarios.id
JOIN curso ON curso.id = funcionarios_curso.curso_id
JOIN aluno_curso ON curso.id = aluno_curso.curso_id
JOIN aluno ON aluno.id = aluno_curso.aluno_id
GROUP BY "Nome do professor","Nome do curso","Nome do aluno";

-- Exercício 2 — Quantos alunos cada professor tem

SELECT funcionarios.nome AS "Nome do professor", COUNT(aluno.id) AS "Quantidade de alunos cadastrados no curso" 
FROM funcionarios 
JOIN funcionarios_curso ON funcionarios_curso.funcionarios_id = funcionarios.id
JOIN curso ON curso.id = funcionarios_curso.curso_id
JOIN aluno_curso ON curso.id = aluno_curso.curso_id
JOIN aluno ON aluno.id = aluno_curso.aluno_id
GROUP BY "Nome do professor";

-- Exercício 3 — Professores sem alunos

SELECT funcionarios.nome AS Nome_do_professor, curso.nome AS Nome_do_curso, aluno.nome AS Nome_do_aluno
FROM funcionarios
LEFT JOIN funcionarios_curso ON funcionarios_curso.funcionarios_id = funcionarios.id
LEFT JOIN curso ON curso.id = funcionarios_curso.curso_id
LEFT JOIN aluno_curso ON curso.id = aluno_curso.curso_id
LEFT JOIN aluno ON aluno.id = aluno_curso.aluno_id
WHERE curso.id IS NOT NULL AND aluno.id IS NULL AND funcionarios.id IS NOT NULL;